@{
    ViewBag.Title = "充值";
}
<div class="modal fade mymodal" id="rechargemodal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" id="recharge-modalcontent">
            <div class="modal-header" data-target="#modal-step-contents">
                <ul class="steps">
                    <li data-step="1" class="active">
                        <span class="step">1</span>
                        <span class="title">充值信息</span>
                    </li>
                    <li data-step="2">
                        <span class="step">2</span>
                        <span class="title">选择员工</span>
                    </li>
                    <li data-step="3">
                        <span class="step">2</span>
                        <span class="title">结算方式</span>
                    </li>
                </ul>
            </div>
            <div class="modal-body step-content" id="modal-step-contents">
                <div class="step-pane active" data-step="1">
                    <form class="form-horizontal" id="rechargeForm0">
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 no-padding-right">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label no-padding-right" for="BillDate">单据日期</label>
                                    <div class="col-xs-12 col-sm-9 no-padding-right">
                                        <span class="block">
                                            <input name="BillDate" class="form-control width-80 form_datetime" id="BillDate" type="text" value="2016/4/3" data-val-required="单据日期 字段是必需的。" data-val="true" data-val-date="字段 单据日期 必须是日期。">
                                        </span>
                                    </div>
                                    <div class="help-block col-xs-12 col-sm-9 col-sm-offset-3 inline">
                                        <mark><b><span class="field-validation-valid text-danger" data-valmsg-replace="true" data-valmsg-for="BillDate"></span></b></mark>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-6 no-padding-right">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label no-padding-right" for="ManualCode">流水单号</label>
                                    <div class="col-xs-12 col-sm-9 no-padding-right">
                                        <span class="block">
                                            <input name="ManualCode" class="width-80" id="ManualCode" type="text" value="" data-val="true" data-val-length-max="50" data-val-length="字段 流水单号 必须是最大长度为 50 的字符串。">
                                        </span>
                                    </div>
                                    <div class="help-block col-xs-12 col-sm-9 col-sm-offset-3 inline">
                                        <mark><b><span class="field-validation-valid text-danger" data-valmsg-replace="true" data-valmsg-for="ManualCode"></span></b></mark>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 no-padding-right">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label no-padding-right" for="MemberName">会员姓名</label>
                                    <div class="col-xs-12 col-sm-9 no-padding-right">
                                        <span class="block">
                                            <input name="MemberName" class="width-80" id="MemberName" type="text" readonly="true" value="111">
                                        </span>
                                    </div>
                                    <div class="help-block col-xs-12 col-sm-9 col-sm-offset-3 inline">
                                        <mark><b><span class="field-validation-valid text-danger" data-valmsg-replace="true" data-valmsg-for="MemberName"></span></b></mark>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-6 no-padding-right">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label no-padding-right" for="MemberCardCode">会员卡号</label>
                                    <div class="col-xs-12 col-sm-9 no-padding-right">
                                        <span class="block">
                                            <input name="MemberCardCode" class="width-80" id="MemberCardCode" type="text" readonly="True" value="111">
                                        </span>
                                    </div>
                                    <div class="help-block col-xs-12 col-sm-9 col-sm-offset-3 inline">
                                        <mark><b><span class="field-validation-valid text-danger" data-valmsg-replace="true" data-valmsg-for="MemberCardCode"></span></b></mark>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 no-padding-right">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label no-padding-right" for="FastMoney">实收金额</label>
                                    <div class="col-xs-12 col-sm-9 no-padding-right">
                                        <span class="block">
                                            <input name="FastMoney" class="width-80" id="FastMoney" onchange="moneyChange(event);" type="text" value="0" data-val-required="实收金额 字段是必需的。" data-val="true" data-val-number="字段 实收金额 必须是一个数字。" data-val-range-min="0.0" data-val-range-max="100000000.0" data-val-range="实收金额不能小于0">
                                        </span>
                                    </div>
                                    <div class="help-block col-xs-12 col-sm-9 col-sm-offset-3 inline">
                                        <mark><b><span class="field-validation-valid text-danger" data-valmsg-replace="true" data-valmsg-for="FastMoney"></span></b></mark>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-6 no-padding-right">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label no-padding-right" for="DonateMoney">赠送金额</label>
                                    <div class="col-xs-12 col-sm-9 no-padding-right">
                                        <span class="block">
                                            <input name="DonateMoney" class="width-80" id="DonateMoney" type="text" value="" data-val="true" data-val-number="字段 赠送金额 必须是一个数字。" data-val-range-min="0.0" data-val-range-max="100000000.0" data-val-range="赠送金额不能小于0">
                                        </span>
                                    </div>
                                    <div class="help-block col-xs-12 col-sm-9 col-sm-offset-3 inline">
                                        <mark><b><span class="field-validation-valid text-danger" data-valmsg-replace="true" data-valmsg-for="DonateMoney"></span></b></mark>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 no-padding-right">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label no-padding-right" for="DonateScore">赠送积分</label>
                                    <div class="col-xs-12 col-sm-9 no-padding-right">
                                        <span class="block">
                                            <input name="DonateScore" class="width-80" id="DonateScore" type="text" value="0.00" data-val="true" data-val-number="字段 赠送积分 必须是一个数字。" data-val-range-min="0.0" data-val-range-max="100000000.0" data-val-range="赠送积分不能小于0">
                                            <input name="ScoreRatio" id="ScoreRatio" type="hidden" value="0.0000" data-val-required="ScoreRatio 字段是必需的。" data-val="true" data-val-number="字段 ScoreRatio 必须是一个数字。">
                                        </span>
                                    </div>
                                    <div class="help-block col-xs-12 col-sm-9 col-sm-offset-3 inline">
                                        <mark><b><span class="field-validation-valid text-danger" data-valmsg-replace="true" data-valmsg-for="DonateScore"></span></b></mark>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-6 no-padding-right">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label no-padding-right" for="Remark">单据备注</label>
                                    <div class="col-xs-12 col-sm-9 no-padding-right">
                                        <span class="block">
                                            <input name="Remark" class="width-80" id="Remark" type="text" value="" data-val="true" data-val-length-max="100" data-val-length="字段 单据备注 必须是最大长度为 100 的字符串。">
                                        </span>
                                    </div>
                                    <div class="help-block col-xs-12 col-sm-9 col-sm-offset-3 inline">
                                        <mark><b><span class="field-validation-valid text-danger" data-valmsg-replace="true" data-valmsg-for="Remark"></span></b></mark>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <input name="MemberCardId" id="MemberCardId" type="hidden" value="87792fdd-e0a5-428d-af99-a5db00d8ba64" data-val-required="MemberCardId 字段是必需的。" data-val="true"><input name="CardCategoryId" id="CardCategoryId" type="hidden" value="cf6525a6-4163-49a4-80de-a5d6016362f1" data-val-required="CardCategoryId 字段是必需的。" data-val="true">
                    </form>
                </div>
                <div class="step-pane" data-step="2">
                    <div class="panel panel-success">
                        <div class="panel-heading">
                            <h3 class="panel-title"><span class="fa fa-user"></span>办卡员工列表</h3>
                        </div>
                        <form id="openCardForm1" action="/OpenCard/Employee" method="post" data-ajax-update="#modal-step2" data-ajax-mode="replace" data-ajax="true">
                            <input name="__RequestVerificationToken" type="hidden" value="4q-mlJWSi79nxXgM-YEvs9lAF9VsVskTfvqZ9ne2sktdlgQa2ziqyM127PG1dHTMv77cDdrE7XZr9hzPpy7tIMks7RPsGbKvF-NgbSLt9qc1">        <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>姓名</th>
                                            <th>职位</th>
                                            <th>业绩</th>
                                            <th>提成</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody id="openCardEmpList">
                                        <tr class="info">
                                            <td>
                                                <div class="action-buttons">
                                                    小红
                                                    <input name="empList[0].EmpName" id="empList_0__EmpName" type="hidden" value="小红">
                                                    <input name="empList[0].EmpId" id="empList_0__EmpId" type="hidden" value="3d3211c6-3b30-4b7a-8a14-a5e000dda19c">
                                                </div>
                                            </td>
                                            <td>
                                                发型师
                                                <input name="empList[0].JobId" id="empList_0__JobId" type="hidden" value="b223d9de-af99-4580-9a17-a5e000dda198">
                                            </td>
                                            <td>
                                                <label class="label label-lg label-primary arrowed-right">业绩率</label>
                                                <input name="empList[0].PerformanceRate" class="input-mini ConsumeList-input empDetail no-padding" id="empList_0__PerformanceRate" onchange="changeEmpRate(event,0,2000,0,3)" type="number" min="0" max="100" step="1" pattern="[0-9]" value="100">            <label class="label label-lg label-primary arrowed-right">业绩</label>
                                                <input name="empList[0].PerformanceMoney" class="input-mini ConsumeList-input empDetail no-padding" id="empList_0__PerformanceMoney" onkeyup="changeEmpMoney(event,3)" onchange="changeEmpMoney(event,3)" type="number" min="0" step="0.01" pattern="[0-9]" value="2000">        <input name="empList[0].PerformanceBase" id="empList_0__PerformanceBase" type="hidden" value="2000">
                                                <input name="empList[0].PerformanceCost" id="empList_0__PerformanceCost" type="hidden" value="0">
                                                <input name="empList[0].PerformanceId" id="empList_0__PerformanceId" type="hidden" value="00000000-0000-0000-0000-000000000000">
                                                <input name="empList[0].PerformanceExId" id="empList_0__PerformanceExId" type="hidden" value="00000000-0000-0000-0000-000000000000">
                                            </td>
                                            <td>
                                                <label class="label label-lg label-pink arrowed-right">提成率</label>
                                                <input name="empList[0].CommissionRate" class="input-mini ConsumeList-input empDetail no-padding" id="empList_0__CommissionRate" onchange="changeEmpRate(event,1,2000,0,3)" type="number" min="0" max="100" step="1" pattern="[0-9]" value="">            <label class="label label-lg label-pink arrowed-right">提成</label>
                                                <input name="empList[0].CommissionMoney" class="empDetail ConsumeList-input input-mini no-padding" id="empList_0__CommissionMoney" type="number" min="0" step="0.01" pattern="[0-9]" value="0">        <input name="empList[0].CommissionBaseMode" id="empList_0__CommissionBaseMode" type="hidden" value="Performance">
                                                <input name="empList[0].CommissionBase" id="empList_0__CommissionBase" type="hidden" value="2000">
                                                <input name="empList[0].CommissionCost" id="empList_0__CommissionCost" type="hidden" value="0">
                                                <input name="empList[0].CommissionId" id="empList_0__CommissionId" type="hidden" value="00000000-0000-0000-0000-000000000000">
                                                <input name="empList[0].CommissionExId" id="empList_0__CommissionExId" type="hidden" value="00000000-0000-0000-0000-000000000000">
                                            </td>
                                            <td class="text-right">
                                                <button class="btn btn-danger btn-xs" onclick="removeCardEmp(0,'/OpenCard/RemoveEmp?index=0')" type="button"><span class="glyphicon glyphicon-trash"></span>删除</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="step-pane" data-step="3">
                    <form id="openCardForm2" action="/OpenCard/Checkout" method="post" data-ajax-update="#modal-step3" data-ajax-mode="replace" data-ajax="true">
                        <input name="__RequestVerificationToken" type="hidden" value="xna3zx7CMP8-D3HbzPBTLeQbP90M3eA0R_pkBO5u1ZVJsoap-eybBsumJ1M_g4pN2ePWW-McmYDy_XhQ7zxij6Ss90WvIgb8lZ6tp6_R5Yc1">    <div class="row">
                            <div class="col-xs-12 col-sm-6 no-padding-right">
                                <div class="form-group has-success">
                                    <label class="col-xs-12 col-sm-3 control-label no-padding-right">充值金额</label>
                                    <div class="col-xs-12 col-sm-9 no-padding-right">
                                        <span class="block">
                                            <input class="width-80" type="number" readonly="true" min="0" value="2200">
                                        </span>
                                    </div>
                                    <div class="help-block col-xs-12 col-sm-9 col-sm-offset-3 inline">
                                        <mark><b></b></mark>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-6 no-padding-right">
                                <div class="form-group has-error">
                                    <label class="col-xs-12 col-sm-3 control-label no-padding-right">应收金额</label>
                                    <div class="col-xs-12 col-sm-9 no-padding-right">
                                        <span class="block">
                                            <input class="width-80" type="text" readonly="true" value="2000">
                                        </span>
                                    </div>
                                    <div class="help-block col-xs-12 col-sm-9 col-sm-offset-3 inline">
                                        <mark><b></b></mark>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="hr hr-dotted"></div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 no-padding-right">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label no-padding-right">现金</label>
                                    <div class="col-xs-12 col-sm-9 no-padding-right">
                                        <span class="block">
                                            <input name="payments[0].FactMoney" class="width-45" id="payments_0__FactMoney" onblur="PaymentNull(this)" onchange="cashChangeMoney(event,2000)" type="number" min="0" step="0.01" pattern="[0-9]" value="2000">                    <span class="label label-xlg label-primary arrowed">
                                                找零:
                                                <span class="badge badge-danger" id="changeMoneyText">0.00</span>
                                            </span>
                                            <input name="payments[0].ChangeMoney" id="payments_0__ChangeMoney" type="hidden" value="0">
                                        </span>
                                    </div>
                                </div>
                                <input name="payments[0].PaymentTermId" id="payments_0__PaymentTermId" type="hidden" value="117393">
                                <input name="payments[0].PaymentType" id="payments_0__PaymentType" type="hidden" value="Cash">
                                <input name="payments[0].MemberAccountId" id="payments_0__MemberAccountId" type="hidden" value="">
                                <input name="payments[0].IsAdmission" id="payments_0__IsAdmission" type="hidden" value="False">
                                <input name="payments[0].IsWeiPay" id="payments_0__IsWeiPay" type="hidden" value="False">
                            </div>
                            <div class="col-xs-12 col-sm-6 no-padding-right">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label no-padding-right">挂账</label>
                                    <div class="col-xs-12 col-sm-9 no-padding-right">
                                        <span class="block">
                                            <input name="payments[1].FactMoney" class="width-80 PaymentMoney" id="payments_1__FactMoney" onblur="PaymentNull(this)" type="number" min="0" step="0.01" pattern="[0-9]" value="0">
                                        </span>
                                    </div>
                                </div>
                                <input name="payments[1].PaymentTermId" id="payments_1__PaymentTermId" type="hidden" value="117396">
                                <input name="payments[1].PaymentType" id="payments_1__PaymentType" type="hidden" value="Debt">
                                <input name="payments[1].MemberAccountId" id="payments_1__MemberAccountId" type="hidden" value="">
                                <input name="payments[1].IsAdmission" id="payments_1__IsAdmission" type="hidden" value="False">
                                <input name="payments[1].IsWeiPay" id="payments_1__IsWeiPay" type="hidden" value="False">
                            </div>
                        </div><div class="row">
                            <div class="col-xs-12 col-sm-6 no-padding-right">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label no-padding-right">银行卡</label>
                                    <div class="col-xs-12 col-sm-9 no-padding-right">
                                        <span class="block">
                                            <input name="payments[2].FactMoney" class="width-80 PaymentMoney" id="payments_2__FactMoney" onblur="PaymentNull(this)" type="number" min="0" step="0.01" pattern="[0-9]" value="0">
                                        </span>
                                    </div>
                                </div>
                                <input name="payments[2].PaymentTermId" id="payments_2__PaymentTermId" type="hidden" value="117398">
                                <input name="payments[2].PaymentType" id="payments_2__PaymentType" type="hidden" value="BankCard">
                                <input name="payments[2].MemberAccountId" id="payments_2__MemberAccountId" type="hidden" value="">
                                <input name="payments[2].IsAdmission" id="payments_2__IsAdmission" type="hidden" value="False">
                                <input name="payments[2].IsWeiPay" id="payments_2__IsWeiPay" type="hidden" value="False">
                            </div>
                            <div class="col-xs-12 col-sm-6 no-padding-right">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label no-padding-right">免单</label>
                                    <div class="col-xs-12 col-sm-9 no-padding-right">
                                        <span class="block">
                                            <input name="payments[3].FactMoney" class="width-80 PaymentMoney" id="payments_3__FactMoney" onblur="PaymentNull(this)" type="number" min="0" step="0.01" pattern="[0-9]" value="0">
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="modal-footer wizard-actions">
            <button class="btn btn-sm btn-prev">
                <i class="ace-icon fa fa-arrow-left"></i> Prev
            </button>
            <button class="btn btn-success btn-sm btn-next" data-last="Finish">
                Next <i class="ace-icon fa fa-arrow-right icon-on-right"></i>
            </button>
            <button class="btn btn-danger btn-sm pull-left" data-dismiss="modal">
                <i class="ace-icon fa fa-times"></i> Cancel
            </button>
        </div>
    </div>
</div>
<script type="text/javascript">
    $LAB.script(js("wizard", "datepicker")).wait(function () {

        $('#recharge-modalcontent').ace_wizard({
            //options
        }).on('actionclicked.fu.wizard', function (e, info) {
            //if (info.step == 1 && $validation) {
            //    if (!$('#validation-form').valid()) e.preventDefault();
            //}
        }).on('finished.fu.wizard', function (e) {
            //swal("Thank you! Your information was successfully saved!");
        }).on('stepclick.fu.wizard', function (e) {
            //e.preventDefault();//阻止点击和选择步骤
        });
    });
</script>
